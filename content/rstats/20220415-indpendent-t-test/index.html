---
title: "Independent sample t-test"
authors:
- admin
date: 2022-04-14T21:13:14-05:00
output:
  html_document:
    highlight: textmate
categories: ["R"]
subtitle: ""
summary: The independent *t* test is used for testing the difference between means of two independent groups. It is particularly useful when the research question requires the comparison of variables (measured at least at the ordinal level) obtained from two independent samples.
tags: ["t-test", "parametric", "compare means"]
---

<link href="{{< blogdown/postref >}}index_files/pagedtable/css/pagedtable.css" rel="stylesheet" />
<script src="{{< blogdown/postref >}}index_files/pagedtable/js/pagedtable.js"></script>


<p><br></p>
<p><img src="/notes/20220415-indpendent-t-test/20220416-t-tests_files/para_non_parametric_tests.jpg"/></p>
<p><br></p>
<div id="aim" class="section level1">
<h1>Aim</h1>
<p>The independent <em>t</em> test is used for testing the difference between means of two independent groups. It is particularly useful when the research question requires the comparison of variables (measured at least at the ordinal level) obtained from two independent samples.</p>
<p><br></p>
</div>
<div id="assumptions" class="section level1">
<h1>Assumptions</h1>
<ul>
<li><p>Independence - the two groups are independent of one another.</p></li>
<li><p>Normality - the dependent variable is normally distributed.</p></li>
<li><p>Homogeneity of variance - the distribution of the dependent variable for one of the groups being compared has the same variance as the distribution for the other group being compared.</p></li>
</ul>
<p><br></p>
</div>
<div id="data" class="section level1">
<h1>Data</h1>
<p>We will use a hypothetical dataset about students’ memory abilities as our sample exercise data. The students were asked to read unrelated words and later were asked to recall as many words as possible. The number of words correctly recalled for each student is shown below. You can access the dataset using this <a href="%22https://raw.githubusercontent.com/chris-allones/Research-methods/master/t-test/data/EX4.sav%22">link</a></p>
<pre class="r"><code># loading the required packages
library(tidyverse)
library(haven) # reading .sav (SPSS) data file
library(ggstatsplot) # creating plots for different stat test
library(patchwork) # for combining plots
library(dlookr) # for normality test

# Loading data
memory_ability &lt;- 
  read_sav(&quot;https://raw.githubusercontent.com/chris-allones/Research-methods/master/t-test/data/EX4.sav&quot;) %&gt;% 
  mutate(gender = as.character(gender),
         gender = factor(gender, levels = 1:2, labels = c(&quot;Male&quot;, &quot;Female&quot;)))

# printing dataset
rmarkdown::paged_table(memory_ability, option = list(rows.print = 5))</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["gender"],"name":[1],"type":["fct"],"align":["left"]},{"label":["words"],"name":[2],"type":["dbl"],"align":["right"]}],"data":[{"1":"Male","2":"16"},{"1":"Male","2":"14"},{"1":"Male","2":"18"},{"1":"Male","2":"25"},{"1":"Male","2":"17"},{"1":"Male","2":"14"},{"1":"Male","2":"19"},{"1":"Male","2":"21"},{"1":"Male","2":"16"},{"1":"Male","2":"17"},{"1":"Female","2":"24"},{"1":"Female","2":"23"},{"1":"Female","2":"26"},{"1":"Female","2":"17"},{"1":"Female","2":"18"},{"1":"Female","2":"20"},{"1":"Female","2":"23"},{"1":"Female","2":"26"},{"1":"Female","2":"24"},{"1":"Female","2":"20"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[5],"max":[5]},"pages":{}}}
  </script>
</div>
<pre class="r"><code># summary
# use psych package for a quick descriptive statistics
psych::describe(memory_ability)</code></pre>
<pre><code>        vars  n mean   sd median trimmed  mad min max range skew kurtosis   se
gender*    1 20  1.5 0.51    1.5    1.50 0.74   1   2     1 0.00     -2.1 0.11
words      2 20 19.9 3.89   19.5   19.88 5.19  14  26    12 0.14     -1.4 0.87</code></pre>
<p><br></p>
</div>
<div id="testing-assumptions" class="section level1">
<h1>Testing assumptions</h1>
<div id="independence" class="section level2">
<h2>Independence</h2>
<p>During data collection, ensure that the observation in one group are independent of the observations of the other group.</p>
<p><br></p>
</div>
<div id="normality-test" class="section level2">
<h2>Normality test</h2>
<p>For a start, a qqplot or the “quantile-quantile” plot can be used to quickly assess whether or not the data or a variable follows a normal distribution. If normally distributed, the data points will lie on the straight diagonal line. For the qqplot below, most of the points lie on the diagonal line but with some deviations along each of the tails.</p>
<pre class="r"><code>qqnorm(memory_ability$words)
qqline(memory_ability$words)</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-3-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Often the visual inspection is hard to see the pattern if the data follows a normal distribution. Therefore, we can use the Shapiro-Wilk test for normality. If the significance level is greater than 0.05, then normality is assumed. The Shapiro-Wilk test is recommended when the sample size is small (~ &lt;50).</p>
<p>We will test the distribution of the number of recalled words for each group (i.e., male and female). Then, we will use the function <code>group_by()</code> to perform the normality test for each <code>gender</code> separately. The result of the Shapiro-Wilk test shows that the computed significance level is greater than 0.05, implying normality can be assumed.</p>
<pre class="r"><code># normality test using the dlookr package
memory_ability %&gt;% 
  group_by(gender) %&gt;% 
  normality(words)</code></pre>
<pre><code># A tibble: 2 × 5
  variable gender statistic p_value sample
  &lt;chr&gt;    &lt;fct&gt;      &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;
1 words    Male       0.902   0.231     10
2 words    Female     0.920   0.355     10</code></pre>
<p><br></p>
</div>
<div id="homogeneity-of-variance" class="section level2">
<h2>Homogeneity of variance</h2>
<p>The Levene’s test can be used to check the assumption on the homogeneity of variance. The Levene’s tes for equality of variance tests the hypothesis that the two population variances are equal.</p>
<p>Why do we need to test for the equality of variance? The answer is that even though there is a large difference in the mean value between groups but with a huge variance (i.e., nonhomogenous variance), the difference may not be significant. On the other hand, a small difference in the mean value may be significant when the variance is small (i.e., homogenous variance).</p>
<p>The results below shows that the Levene statistic is <span class="math inline">\(F=0.087\)</span> and the corresponding level of significance is large (i.e., <span class="math inline">\(p&gt;0.05\)</span>). Hence, the assumption of homogeneity of variance has not been violated, and the equal variances assumed implying <em>t</em> test statistic can be used for evaluating the null hypothesis of equality of means.</p>
<pre class="r"><code>car::leveneTest(words ~ gender, data = memory_ability, center = &quot;mean&quot;)</code></pre>
<pre><code>Levene&#39;s Test for Homogeneity of Variance (center = &quot;mean&quot;)
      Df F value Pr(&gt;F)
group  1  0.0869 0.7715
      18               </code></pre>
<p><br></p>
</div>
</div>
<div id="results-and-interpretation" class="section level1">
<h1>Results and interpretation</h1>
<p>The result from the <span class="math inline">\(t\)</span> test indicate that there is a significant difference between the male and female samples in the number of words correctly recalled, <span class="math inline">\(t(df=18)=-3.02, p&lt;0.01\)</span>. The mean values indicate that females correctly recalled significantly more words (M=22.10) than males(M=17.70).</p>
<p>The confidence interval information shows that the null hypothesis value (i.e., zero) does not fall within the interval. Therefore the null hypothesis of equality of means can be rejected.</p>
<pre class="r"><code>ind_ttest &lt;- 
t.test(words ~ gender, data = memory_ability, alternative = &quot;two.sided&quot;)

ind_ttest</code></pre>
<pre><code>
    Welch Two Sample t-test

data:  words by gender
t = -3.0203, df = 17.958, p-value = 0.007367
alternative hypothesis: true difference in means between group Male and group Female is not equal to 0
95 percent confidence interval:
 -7.461101 -1.338899
sample estimates:
  mean in group Male mean in group Female 
                17.7                 22.1 </code></pre>
<pre class="r"><code>ggbetweenstats(
  data = memory_ability,
  x = gender,
  y = words,
  type = &quot;parametric&quot;,
  var.equal = TRUE # homogenous variance from Leven&#39;s test
) + 
  theme(text = element_text(size = 24)) # increase text size</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-7-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>We can also compute for the eta-square (<span class="math inline">\(\eta^2\)</span>) which can be interpreted in exactly the same as <span class="math inline">\(R^2\)</span> in correlation and regression. That is, approximately 33.63% of the variability in the number of words correctly recalled was explained by the gender manipulation. Eta-square can be calculated by:</p>
<p><span class="math display">\[\eta^2 = \frac{t^2}{t^2 + df}\]</span></p>
<pre class="r"><code>ind_ttest$statistic^2 / (ind_ttest$statistic^2 + ind_ttest$parameter)</code></pre>
<pre><code>        t 
0.3368622 </code></pre>
<p><br></p>
</div>
<div id="manual-computation" class="section level1">
<h1>Manual computation</h1>
<p>The t statistic for the t test for independent sample is given by:</p>
<p><span class="math display">\[
t = \frac{\bar{X_1} - \bar{X_2}}{\sqrt{\frac{s_1^2}{n_1} + \frac{s_2^2}{n_1}}}
\]</span></p>
<p>where <span class="math inline">\(\bar{X}\)</span> is the mean value for each group, <span class="math inline">\(S^2\)</span> is the sample variance, and <span class="math inline">\(n\)</span> number of observation in each group.</p>
<pre class="r"><code># X1 - mean words recalled by male
mean_male &lt;- 
memory_ability %&gt;% filter(gender == &quot;Male&quot;) %&gt;% summarise(m_words = mean(words)) %&gt;% pull()

# X2 - mean words recalled by female
mean_female &lt;- 
memory_ability %&gt;% filter(gender == &quot;Female&quot;) %&gt;% summarise(m_words = mean(words)) %&gt;% pull()

# s1 - variance of words recalled by male
variance_male &lt;- 
memory_ability %&gt;% filter(gender == &quot;Male&quot;) %&gt;% summarise(m_words = var(words)) %&gt;% pull()

# s2 - variance of words recalled by female
variance_female &lt;- 
memory_ability %&gt;% filter(gender == &quot;Female&quot;) %&gt;% summarise(m_words = var(words)) %&gt;% pull()

# no of male
n_male &lt;- 
memory_ability %&gt;% filter(gender == &quot;Male&quot;) %&gt;% count() %&gt;% pull()

# no of female
n_female &lt;- 
memory_ability %&gt;% filter(gender == &quot;Female&quot;) %&gt;% count() %&gt;% pull()</code></pre>
<pre class="r"><code># Computing the t statistic
t_stat &lt;- 
(mean_male - mean_female) / sqrt((variance_male/n_male) + (variance_female/ n_female))

t_stat</code></pre>
<pre><code>[1] -3.02035</code></pre>
<pre class="r"><code># Deriving the two-tailed p-value
pt(q = t_stat, df = 18) * 2</code></pre>
<pre><code>[1] 0.007352521</code></pre>
<p><br></p>
<hr />
<div id="references" class="section level2">
<h2>References</h2>
<p>Ho, Robert (2014).Handbook of Univariate and Multivariate Data Analysis with IBM SPSS (2nd edition). Chapman &amp; Hall/CRC, Taylor &amp; Francis Group.</p>
<p>Sheskin, David J. (2011). Handbook of Parametric and Nonparametric Statistical Procedures (5th edition). Chapman &amp; Hall/CRC, Taylor &amp; Francis Group.</p>
</div>
</div>
